<%- include('../includes/head.ejs') %>
<link rel="stylesheet" href="/css/favorites.css">

<body class="bg-gray-50 min-h-screen">
    <%- include('../includes/navigation.ejs') %>
    
    <!-- Hero Section -->
    <section class="favorites-hero">
        <div class="container mx-auto px-4">
            <div class="text-center">
                <h1>
                    <i class="ri-heart-fill mr-3"></i>
                    Sản phẩm yêu thích
                </h1>
                <p class="text-gray-600 text-lg">Những sản phẩm bạn đã thêm vào danh sách yêu thích</p>
            </div>
        </div>
    </section>

    <main class="container mx-auto px-4">
        <!-- Stats Section -->
        <div class="favorites-stats">
            <div class="stat-card">
                <div class="stat-number"><%= products ? products.length : 0 %></div>
                <div class="stat-label">Sản phẩm yêu thích</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">
                    <%= products ? products.reduce((total, product) => total + product.price, 0).toLocaleString('vi-VN') : '0' %> ₫
                </div>
                <div class="stat-label">Tổng giá trị</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">
                    <%= products ? Math.round(products.reduce((total, product) => total + product.price, 0) / products.length).toLocaleString('vi-VN') : '0' %> ₫
                </div>
                <div class="stat-label">Giá trung bình</div>
            </div>
        </div>

        <!-- Favorites Grid -->
        <% if (products && products.length > 0) { %>
            <div class="favorites-grid">
                <% products.forEach(product => { %>
                    <div class="favorite-card" data-product-id="<%= product._id %>">
                        <div class="favorite-card-image">
                            <img src="<%= product.imageUrl %>" alt="<%= product.title %>" loading="lazy">
                            <div class="favorite-badge">
                                <i class="ri-heart-fill mr-1"></i>
                                Yêu thích
                            </div>
                        </div>
                        <div class="favorite-card-content">
                            <h3 class="favorite-card-title"><%= product.title %></h3>
                            <p class="favorite-card-description"><%= product.description %></p>
                            <div class="favorite-card-price">
                                <%= product.price.toLocaleString('vi-VN') %> ₫
                            </div>
                            <div class="favorite-card-actions">
                                <a href="/products/<%= product._id %>" class="btn-view-detail">
                                    <i class="ri-eye-line"></i>
                                    Xem chi tiết
                                </a>
                                <button class="btn-remove-favorite" onclick="removeFavorite('<%= product._id %>')">
                                    <i class="ri-heart-fill"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                <% }) %>
            </div>
        <% } else { %>
            <div class="empty-favorites">
                <div class="empty-favorites-icon">
                    <i class="ri-heart-line"></i>
                </div>
                <h2>Chưa có sản phẩm yêu thích</h2>
                <p>Hãy khám phá và thêm những sản phẩm bạn yêu thích vào danh sách này!</p>
                <a href="/products" class="btn-explore">
                    <i class="ri-store-line"></i>
                    Khám phá sản phẩm
                </a>
            </div>
        <% } %>
    </main>

    <script src="/js/favorites.js"></script>

    <%- include('../includes/end.ejs') %>